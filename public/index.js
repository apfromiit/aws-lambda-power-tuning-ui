(()=>{var P=(t,e,s)=>{if(!e.has(t))throw TypeError("Cannot "+s)};var R=(t,e,s)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,s)};var $=(t,e,s)=>(P(t,e,"access private method"),s);function L(t,e=Float32Array){return t=new e(t),t instanceof Uint8Array||(t=new Uint8Array(t.buffer)),window.base64js.fromByteArray(t)}function b(t,e=Float32Array){return Array.from(new e(window.base64js.toByteArray(t).buffer))}var H="https://github.com/matteo-ronchetti/aws-lambda-power-tuning-ui",m=";",F=3,M=8,c={red:"rgb(255, 99, 132)",blue:"rgb(54, 162, 235)",orange:"rgb(255, 165, 00)",green:"rgb(34, 139, 34)"},S={responsive:!0,hoverMode:"index",tooltips:{mode:"index",intersect:!1,enabled:!1,custom:D},stacked:!1,title:{display:!1},scales:{xAxes:[{scaleLabel:{display:!0,labelString:"Memory / Power (MB)"}}],yAxes:[{ticks:{beginAtZero:!0,callback:t=>`${d(t)} ms`},type:"linear",display:!0,scaleLabel:{display:!0,labelString:"Invocation Time"},position:"left",id:"time-axis"},{ticks:{beginAtZero:!0,callback:t=>`${d(t)} $`},type:"linear",display:!0,position:"right",id:"cost-axis",scaleLabel:{display:!0,labelString:"Invocation Cost"},gridLines:{drawOnChartArea:!1}}]}},w=class{constructor(e){this.store=e,this.canvas=document.querySelector("canvas"),this.reportElem=document.getElementById("report"),this.errorElem=document.getElementById("error"),this.data1=null,this.data1URL="",this.data2=null,this.data2URL="",this.legend1="",this.legend2="",this.store.addListener(this.show.bind(this),this.error.bind(this))}setData1(e){this.data1=T(e),this.data1URL=x(e.join(m))}setData2(e){this.data2=T(e),this.data2URL=x(e.join(m))}error(e){switch(this.reportElem.style.display="none",this.errorElem.style.display="flex",e){case"empty":let s=x(L([128,256,512,1024],Int16Array)+m+L([36555.39,18441.58,8539.34,3870.76])+m+L([7612e-8,7696e-8,7155e-8,6489e-8]));document.getElementById("error-title").innerHTML="Error: URL must contain data in the hash!",document.getElementById("error-msg").innerHTML=`Your URL is ${window.location} and should be something like <a href="${s}" class="dont-break-out">${s}</a><br>Please refer to the <a href="${H}">documentation</a>.`;break;case"malformed":document.getElementById("error-title").innerHTML="Error: malformed URL parameters!",document.getElementById("error-msg").innerHTML=`Please check your URL parameters, refer to the <a href='${H}#url-format'>documentation</a>.`;break;default:document.getElementById("error-title").innerHTML="Error",document.getElementById("error-msg").innerHTML="Please check your URL parameters"}}show(e){let s=e.split(m),i=s.length;this.legend1="",this.legend2="",i!==F&&i!==M&&this.error("malformed");try{this.setData1(s.slice(0,3))}catch(n){console.error(n),this.error("malformed");return}if(i===M){try{this.setData2(s.slice(3,6))}catch(n){console.error(n),this.error("malformed");return}this.legend1=decodeURIComponent(s[6]),this.legend2=decodeURIComponent(s[7])}else this.data2=null,this.data2URL="",this.legend1="",this.legend2="";this.reportElem.style.display="flex",this.errorElem.style.display="none",this.showCards(this.data1);let a=this.data1.powers;if(this.data2){a=this.data1.powers.concat(this.data2.powers),a=a.filter((n,l)=>a.indexOf(n)===l),a.sort((n,l)=>n-l);for(let[n,l]of a.entries())this.data1.powers.includes(l)||(this.data1.times.splice(n,0,null),this.data1.costs.splice(n,0,null)),this.data2.powers.includes(l)||(this.data2.times.splice(n,0,null),this.data2.costs.splice(n,0,null))}let o={labels:a,datasets:[{label:`Invocation Time ${this.legend1?this.legend1+" ":""}(ms)`,borderColor:c.red,backgroundColor:c.red,fill:!1,data:this.data1.times,yAxisID:"time-axis"},{label:`Invocation Cost ${this.legend1?this.legend1+" ":""}(USD)`,borderColor:c.blue,backgroundColor:c.blue,fill:!1,data:this.data1.costs,yAxisID:"cost-axis"}]};this.data2&&o.datasets.push({label:`Invocation Time ${this.legend2?this.legend2+" ":""}(ms)`,borderColor:c.orange,backgroundColor:c.orange,fill:!1,data:this.data2.times,yAxisID:"time-axis"},{label:`Invocation Cost ${this.legend2?this.legend2+" ":""}(USD)`,borderColor:c.green,backgroundColor:c.green,fill:!1,data:this.data2.costs,yAxisID:"cost-axis"}),this.myLine&&this.myLine.destroy();let r=this.canvas.getContext("2d");this.myLine=window.Chart.Line(r,{data:o,options:S})}showCards(e){let i=Math.max(...e.costs),a=Math.max(...e.times),o=e.powers.map((r,n)=>({size:r,time:e.times[n],cost:e.costs[n],value:.5*e.costs[n]/i+(1-.5)*e.times[n]/a}));o.sort((r,n)=>r.time-n.time),document.getElementById("min-time").innerHTML=`${o[0].size}MB`,document.getElementById("max-time").innerHTML=`${o[o.length-1].size}MB`,o.sort((r,n)=>r.cost-n.cost),document.getElementById("min-cost").innerHTML=`${o[0].size}MB`,document.getElementById("max-cost").innerHTML=`${o[o.length-1].size}MB`,o.sort((r,n)=>r.value-n.value),document.getElementById("balanced").innerHTML=`${o[0].size}MB`}compare(e,s,i,a){this.store.setState([e,s,encodeURIComponent(i),encodeURIComponent(a)].join(m))}};function T(t){let e=b(t[0],Int16Array),s=b(t[1]),i=b(t[2]);return{powers:e,times:s,costs:i}}function x(t){return`${window.location.origin}${window.location.pathname}#${t}`}function D(t){let e=document.getElementById("tooltip"),s=document.getElementById("tooltip-power"),i=document.getElementById("tooltip-time-1"),a=document.getElementById("tooltip-cost-1"),o=document.getElementById("tooltip-time-2"),r=document.getElementById("tooltip-cost-2"),n=document.getElementById("tooltip-separator");if(t.opacity===0){e.style.display="none";return}let l=t.dataPoints[0].label,p=d(parseFloat(t.dataPoints[0].value)),h=d(parseFloat(t.dataPoints[1].value),2);if(s.innerHTML=`Power: ${l}`,i.innerHTML=`Time: ${p}ms`,a.innerHTML=`Cost: ${h}$`,t.dataPoints[2]&&t.dataPoints[2].value){let f=d(parseFloat(t.dataPoints[2].value)),C=d(parseFloat(t.dataPoints[3].value),2),v=d(f*100/p)-100,B=d(C*100/h)-100,k=v<0?"faster":"slower",A=B>0?"more expensive":"cheaper";o.innerHTML=`Time: ${f}ms (${Math.sign(v)*v}% ${k})`,r.innerHTML=`Cost: ${C}$ (${Math.sign(B)*B}% ${A})`,o.style.display="block",r.style.display="block",n.style.display="block"}else o.style.display="none",r.style.display="none",n.style.display="none";let g=this._chart.canvas.getBoundingClientRect();e.style.display="block",e.style.left=g.left+window.pageXOffset+t.caretX+"px",e.style.top=g.top+window.pageYOffset+t.caretY+"px",e.style.fontFamily=t._bodyFontFamily,e.style.fontSize=t.bodyFontSize+"px",e.style.fontStyle=t._bodyFontStyle,e.style.pointerEvents="none"}function d(t,e=1){if(t<1e-12)return t.toFixed(e).replace(/(\.0*[1-9]+)[0]+$|\.[0]+$/,"$1");let s=Math.max(-Math.round(Math.log10(t))+e,0);return t.toFixed(s).replace(/(\.0*[1-9]+)[0]+$|\.[0]+$/,"$1")}var u,U,I=class{constructor(){R(this,u);this.listeners=[],window.addEventListener("hashchange",$(this,u,U).bind(this))}addListener(e,s){this.listeners.push([e,s]),$(this,u,U).call(this)}setState(e){window.location.hash=e}};u=new WeakSet,U=function(){window.location.hash?this.listeners.forEach(([e])=>e(window.location.hash.slice(1))):this.listeners.forEach(([,e])=>e("empty"))};var y=new w(new I),E=document.getElementById("modal-compare");z();function z(){window.addEventListener("click",t=>{t.target===E&&(E.style.display="none")}),O()}function O(){let t=document.getElementById("compare"),e=document.getElementById("confirm-compare"),s=document.getElementById("compare-f1-name"),i=document.getElementById("compare-f1-url"),a=document.getElementById("compare-f2-name"),o=document.getElementById("compare-f2-url");t.addEventListener("click",function(){E.style.display="block",s.value=y.legend1,i.value=y.data1URL,a.value=y.legend2,o.value=y.data2URL}),e.addEventListener("click",function(r){let n=i.value||"",[,l]=n.split("#");if(!l){alert("Invalid URL for function 1. Please try again with a valid visualization URL.");return}let p=o.value||"",[,h]=p.split("#");if(!h){alert("Invalid URL for function 2. Please try again with a valid visualization URL.");return}let g=s.value||"",f=a.value||"";return E.style.display="none",r.stopPropagation(),y.compare(l,h,g,f),!1})}})();
//# sourceMappingURL=index.js.map
